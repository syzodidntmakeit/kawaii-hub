<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kawaii Server Hub</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts: Poppins -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;800&display=swap" rel="stylesheet">
    
    <style>
        /* Define custom colors and font */
        :root {
            --bg-1: #ffeef8;   /* soft pink */
            --bg-2: #e8f3ff;   /* baby blue */
            --accent: #ff7ab6; /* pink accent */
            --muted: #6b6b80;
            --text-main: #3a3a50;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(160deg, var(--bg-2), var(--bg-1));
            color: var(--muted);
            min-height: 100vh;
            transition: background 0.3s, color 0.3s;
        }

        /* Sakura Petals */
        .petal {
            position: fixed;
            pointer-events: none;
            z-index: 10;
            opacity: 0; /* Start invisible */
            font-size: 20px;
        }
        @keyframes fall {
            0% { 
                transform: translateY(-20vh) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 0.9; /* Fade in as they start falling */
            }
            100% { 
                transform: translateY(110vh) rotate(360deg); 
                opacity: 1;
            }
        }

        /* Glassmorphism Card Effect */
        .glass {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.18);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);
            transition: background-color 0.3s, border-color 0.3s;
        }

        /* Night Mode */
        .night-mode {
            background: linear-gradient(160deg, #0d1117, #1f2937) !important;
            color: #c9d1d9 !important;
        }
        .night-mode .glass {
            background: rgba(22, 27, 34, 0.7);
            border-color: rgba(255, 255, 255, 0.1);
        }
        .night-mode h1, .night-mode h2, .night-mode h3, .night-mode h4, .night-mode .font-semibold {
            color: #e6edf3;
        }
        .night-mode span.text-\[var\(--accent\)\] {
           color: #f78166; /* Coral accent for dark mode */
        }
        .night-mode input {
            background: rgba(255,255,255,0.05) !important;
            border-color: rgba(255,255,255,0.2) !important;
            color: #c9d1d9;
        }
        .night-mode .petal {
            display: none; /* Hide petals in night mode */
        }

        /* Main layout grid */
        @media (min-width: 1024px) {
            .content-grid { grid-template-columns: 1fr 420px; }
        }

        /* Jukebox Visualizer */
        .visualizer {
            display: flex;
            align-items: flex-end;
            justify-content: center;
            height: 40px;
            gap: 2px;
            transition: opacity 0.3s ease;
        }
        .bar {
            width: 4px; /* Slightly thicker bars */
            background: linear-gradient(to top, var(--accent), #ff9bd4);
            border-radius: 2px;
            height: 4px; /* Start at min height */
            transition: height 0.05s ease-out; /* Smooth transitions for real data */
        }
        
        /* Chatbot styles */
        .chat-container {
            height: 300px;
            overflow-y: auto;
        }
        .chat-bubble {
            max-width: 80%;
            padding: 8px 12px;
            border-radius: 18px;
            word-wrap: break-word;
        }
        .chat-bubble.user {
            background-color: var(--accent);
            color: white;
            border-bottom-right-radius: 4px;
        }
        .chat-bubble.bot {
            background-color: #e5e7eb;
            color: #374151;
            border-bottom-left-radius: 4px;
        }
        .night-mode .chat-bubble.bot {
            background-color: #374151;
            color: #e6edf3;
        }
    </style>
</head>
<body class="antialiased">

    <!-- Sakura petals (decor) -->
    <div id="petal-wrap"></div>

    <div class="max-w-7xl mx-auto p-4 sm:p-6 lg:p-8">
        <!-- Header -->
        <header class="flex items-center justify-between gap-6 flex-wrap mb-8">
            <a href="#" class="flex items-center gap-4">
                <div class="w-16 h-16 bg-white rounded-2xl flex items-center justify-center shadow-md overflow-hidden">
                    <!-- USER: Replace with your logo, e.g., ./assets/logo.png -->
                    <img src="https://placehold.co/64x64/ffeef8/ff7ab6?text=🌸" alt="kawaii icon" class="w-14 h-14 object-cover rounded-xl">
                </div>
                <div>
                    <h1 class="text-2xl lg:text-3xl font-extrabold" style="color: var(--text-main);">kawaii-san<span class="text-[var(--accent)]">.org</span></h1>
                    <p class="text-sm text-[var(--muted)] -mt-1">cozy server den • chibi engineer energy</p>
                </div>
            </a>
            
            <div class="flex-1 max-w-md mx-auto order-3 lg:order-2">
                <form action="https://search.kawaii-san.org/search" method="get" target="_blank" class="relative">
                    <input type="text" name="q" placeholder="Search with Whoogle..." class="w-full px-4 py-2 pr-10 rounded-lg border border-gray-200 bg-white/80 backdrop-blur-sm text-sm focus:outline-none focus:ring-2 focus:ring-[var(--accent)] focus:border-transparent transition">
                    <button type="submit" class="absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-[var(--accent)]">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                    </button>
                </form>
            </div>

            <nav class="flex items-center gap-3 order-2 lg:order-3">
                <button id="theme-toggle" class="px-3 py-2 rounded-lg glass text-sm font-semibold">Night Mode</button>
                <a href="#projects" class="px-4 py-2 rounded-lg bg-[var(--accent)] text-white text-sm font-semibold">Projects</a>
            </nav>
        </header>

        <main class="grid gap-8 content-grid">
            
            <!-- ===================== MAIN FRAME ===================== -->
            <section id="main-frame" class="flex flex-col gap-8">
                <!-- AI Playground -->
                <div class="glass p-6 rounded-2xl">
                    <h2 class="text-2xl font-bold mb-4" style="color: var(--text-main);">AI Playground</h2>
                    <div id="chat-container" class="chat-container bg-white/50 rounded-lg p-4 space-y-4 mb-4">
                        <div class="flex justify-start">
                            <div class="chat-bubble bot">
                                Hi there! I'm your local AI assistant, connected to Ollama. Ask me anything!
                            </div>
                        </div>
                    </div>
                    <form id="chat-form" class="flex gap-4">
                        <input id="chat-input" type="text" placeholder="Chat with a local model..." class="flex-1 px-4 py-2 rounded-lg border border-gray-200 bg-white/80 text-sm focus:outline-none focus:ring-2 focus:ring-[var(--accent)] focus:border-transparent transition">
                        <button type="submit" class="px-4 py-2 rounded-lg bg-[var(--accent)] text-white text-sm font-semibold">Send</button>
                    </form>
                </div>

                <!-- Projects Grid -->
                <div id="projects" class="glass p-6 rounded-2xl">
                    <h2 class="text-2xl font-bold mb-4" style="color: var(--text-main);">Services</h2>
                    <div class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
                        <a class="block p-4 rounded-2xl glass shadow-sm border hover:scale-[1.02] hover:shadow-lg transition-all" href="https://anime.kawaii-san.org" target="_blank">
                            <div class="flex items-start gap-3"><div class="w-12 h-12 rounded-lg bg-white flex items-center justify-center"><img src="https://placehold.co/48x48/fff/E1306C?text=J" alt="Jellyfin"></div><div><div class="font-semibold" style="color: var(--text-main);">Jellyfin</div><div class="text-xs text-[var(--muted)]">Media server for movies & anime.</div></div></div>
                        </a>
                        <a class="block p-4 rounded-2xl glass shadow-sm border hover:scale-[1.02] hover:shadow-lg transition-all" href="https://music.kawaii-san.org" target="_blank">
                            <div class="flex items-start gap-3"><div class="w-12 h-12 rounded-lg bg-white flex items-center justify-center"><img src="https://placehold.co/48x48/fff/8B5CF6?text=N" alt="Navidrome"></div><div><div class="font-semibold" style="color: var(--text-main);">Navidrome</div><div class="text-xs text-[var(--muted)]">Music library for lofi & vibes.</div></div></div>
                        </a>
                        <a class="block p-4 rounded-2xl glass shadow-sm border hover:scale-[1.02] hover:shadow-lg transition-all" href="https://mypookie.kawaii-san.org" target="_blank">
                            <div class="flex items-start gap-3"><div class="w-12 h-12 rounded-lg bg-white flex items-center justify-center"><img src="https://placehold.co/48x48/fff/F59E0B?text=AI" alt="AI"></div><div><div class="font-semibold" style="color: var(--text-main);">AI Playground</div><div class="text-xs text-[var(--muted)]">Messing with local LLMs.</div></div></div>
                        </a>
                        <a class="block p-4 rounded-2xl glass shadow-sm border hover:scale-[1.02] hover:shadow-lg transition-all" href="https://files.kawaii-san.org" target="_blank">
                            <div class="flex items-start gap-3"><div class="w-12 h-12 rounded-lg bg-white flex items-center justify-center"><img src="https://placehold.co/48x48/fff/3B82F6?text=F" alt="Filebrowser"></div><div><div class="font-semibold" style="color: var(--text-main);">Filebrowser</div><div class="text-xs text-[var(--muted)]">Simple web file manager.</div></div></div>
                        </a>
                        <a class="block p-4 rounded-2xl glass shadow-sm border hover:scale-[1.02] hover:shadow-lg transition-all" href="https://cloud.kawaii-san.org" target="_blank">
                            <div class="flex items-start gap-3"><div class="w-12 h-12 rounded-lg bg-white flex items-center justify-center"><img src="https://placehold.co/48x48/fff/0EA5E9?text=NC" alt="Nextcloud"></div><div><div class="font-semibold" style="color: var(--text-main);">Nextcloud</div><div class="text-xs text-[var(--muted)]">My personal cloud storage.</div></div></div>
                        </a>
                        <a class="block p-4 rounded-2xl glass shadow-sm border hover:scale-[1.02] hover:shadow-lg transition-all" href="https://torrent.kawaii-san.org" target="_blank">
                            <div class="flex items-start gap-3"><div class="w-12 h-12 rounded-lg bg-white flex items-center justify-center"><img src="https://placehold.co/48x48/fff/22C55E?text=qB" alt="qBittorrent"></div><div><div class="font-semibold" style="color: var(--text-main);">qBittorrent</div><div class="text-xs text-[var(--muted)]">For... completely legal ISOs.</div></div></div>
                        </a>
                        <a class="block p-4 rounded-2xl glass shadow-sm border hover:scale-[1.02] hover:shadow-lg transition-all" href="https://notes.kawaii-san.org" target="_blank">
                            <div class="flex items-start gap-3"><div class="w-12 h-12 rounded-lg bg-white flex items-center justify-center"><img src="https://placehold.co/48x48/fff/10B981?text=T" alt="Trilium"></div><div><div class="font-semibold" style="color: var(--text-main);">Trilium</div><div class="text-xs text-[var(--muted)]">My second brain / knowledge base.</div></div></div>
                        </a>
                        <a class="block p-4 rounded-2xl glass shadow-sm border hover:scale-[1.02] hover:shadow-lg transition-all" href="https://docker.kawaii-san.org" target="_blank">
                            <div class="flex items-start gap-3"><div class="w-12 h-12 rounded-lg bg-white flex items-center justify-center"><img src="https://placehold.co/48x48/fff/06B6D4?text=P" alt="Portainer"></div><div><div class="font-semibold" style="color: var(--text-main);">Portainer</div><div class="text-xs text-[var(--muted)]">Easy Docker container management.</div></div></div>
                        </a>
                        <a class="block p-4 rounded-2xl glass shadow-sm border hover:scale-[1.02] hover:shadow-lg transition-all" href="https://monitor.kawaii-san.org" target="_blank">
                            <div class="flex items-start gap-3"><div class="w-12 h-12 rounded-lg bg-white flex items-center justify-center"><img src="https://placehold.co/48x48/fff/6366F1?text=M" alt="Monitor"></div><div><div class="font-semibold" style="color: var(--text-main);">Monitor</div><div class="text-xs text-[var(--muted)]">Netdata status page.</div></div></div>
                        </a>
                    </div>
                </div>
                
                <!-- Music Library -->
                <div class="glass p-6 rounded-2xl">
                    <h2 class="text-2xl font-bold mb-4" style="color: var(--text-main);">Music Library</h2>
                    <div id="album-grid" class="grid gap-4 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4">
                        <!-- Albums from Navidrome will be loaded here -->
                        <button data-album-name="Madvillainy" class="block p-3 rounded-2xl glass shadow-sm border hover:scale-[1.02] hover:shadow-lg transition-all text-left">
                            <img src="https://placehold.co/160x160/111/fff?text=Madvillainy" alt="Madvillainy" class="w-full h-auto rounded-lg mb-2 aspect-square object-cover">
                            <div class="font-semibold text-sm truncate" style="color: var(--text-main);">Madvillainy</div>
                            <div class="text-xs text-[var(--muted)] truncate">Madvillain</div>
                        </button>
                        <button data-album-name="Mr. Morale and the Big Steppers" class="block p-3 rounded-2xl glass shadow-sm border hover:scale-[1.02] hover:shadow-lg transition-all text-left">
                            <img src="https://placehold.co/160x160/111/fff?text=MMATBS" alt="Mr.Morale" class="w-full h-auto rounded-lg mb-2 aspect-square object-cover">
                            <div class="font-semibold text-sm truncate" style="color: var(--text-main);">Mr. Morale and the Big Steppers</div>
                            <div class="text-xs text-[var(--muted)] truncate">Kendrick Lamar</div>
                        </button>
                    </div>
                </div>
            </section>

            <!-- ===================== SIDE FRAME ==================== -->
            <aside id="side-frame" class="flex flex-col gap-8">
                <div class="glass p-6 rounded-2xl">
                    <h3 class="font-bold text-lg mb-2" style="color: var(--text-main);">About Me</h3>
                    <p class="text-sm text-[var(--muted)]">19yo engineering student drowning in circuits and code. When I'm not debugging hardware or crying over Fourier transforms, I'm vibing to hip-hop beats and binge-watching anime till 3am. Welcome to my organized chaos! ✨</p>
                    <div class="mt-4 pt-4 border-t border-gray-200/50">
                        <h4 class="font-semibold text-sm">Follow</h4>
                        <div class="mt-2 flex gap-2 flex-wrap">
                            <a class="flex items-center gap-2 px-3 py-2 rounded-lg bg-gray-800 text-white text-sm hover:bg-gray-700 transition-colors" href="https://github.com/syzodidntmakeit" target="_blank"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>GitHub</a>
                            <a class="flex items-center gap-2 px-3 py-2 rounded-lg bg-gradient-to-r from-purple-500 to-pink-500 text-white text-sm" href="https://instagram.com/isaiah.rawr" target="_blank"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></svg>Instagram</a>
                            <button class="flex items-center gap-2 px-3 py-2 rounded-lg bg-indigo-600 text-white text-sm" onclick="copyToClipboard('@syzodidntmakeit', this)"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419-.0002 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9554 2.4189-2.1568 2.4189z"/></svg>Discord</button>
                        </div>
                    </div>
                </div>
                <div class="glass p-4 rounded-2xl">
                    <h3 class="font-bold text-lg mb-2" style="color: var(--text-main);">Mini Jukebox</h3>
                    <p class="text-xs text-[var(--muted)] mt-1">Press play for lo-fi / hip-hop vibes.</p>
                    <div id="visualizer" class="visualizer mt-3">
                        <!-- Bars will be generated by JS -->
                    </div>
                    <div class="mt-3 flex items-center justify-center gap-2">
                        <button id="prev-btn" class="p-2 rounded-full border text-sm hover:bg-white/50"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path d="M8.445 14.832A1 1 0 0010 14.032V5.968a1 1 0 00-1.555-.832L4.445 9.168a1 1 0 000 1.664l4 3.001zM14.445 14.832A1 1 0 0016 14.032V5.968a1 1 0 00-1.555-.832L10.445 9.168a1 1 0 000 1.664l4 3.001z"/></svg></button>
                        <button id="play-btn" class="p-2 rounded-full bg-[var(--accent)] text-white text-sm"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path d="M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"/></svg></button>
                        <button id="stop-btn" class="p-2 rounded-full border text-sm hover:bg-white/50"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path d="M5 6.25a1.25 1.25 0 112.5 0v7.5a1.25 1.25 0 11-2.5 0v-7.5zm7.5-1.25a1.25 1.25 0 100 2.5h-5a1.25 1.25 0 100-2.5h5z"/></svg></button>
                        <button id="next-btn" class="p-2 rounded-full border text-sm hover:bg-white/50"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path d="M5.555 5.168A1 1 0 004 5.968v8.064a1 1 0 001.555.832L9.555 11a1 1 0 000-1.664l-4-3.168zM11.555 5.168A1 1 0 0010 5.968v8.064a1 1 0 001.555.832L15.555 11a1 1 0 000-1.664l-4-3.168z"/></svg></button>
                    </div>
                    <div id="track-info" class="mt-2 text-xs text-[var(--muted)] truncate text-center">Ready to play...</div>
                </div>
                <div class="glass p-6 rounded-2xl">
                    <h3 class="font-bold text-lg" style="color: var(--text-main);">System Snapshot</h3>
                    <div id="sys-snapshot" class="mt-3 space-y-2 text-sm">
                        <div><span class="text-[var(--muted)]">CPU:</span> <span id="cpu-usage">Loading...</span></div>
                        <div><span class="text-[var(--muted)]">Memory:</span> <span id="memory-usage">Loading...</span></div>
                        <div><span class="text-[var(--muted)]">Uptime:</span> <span id="uptime">Loading...</span></div>
                    </div>
                    <div class="mt-4 pt-4 border-t border-gray-200/50">
                        <h4 class="font-semibold text-sm">Local Weather</h4>
                        <div id="weather-info" class="mt-1 text-sm text-[var(--muted)]">Loading...</div>
                    </div>
                </div>
                <div class="glass p-4 rounded-2xl">
                    <h3 class="font-bold text-lg mb-2" style="color: var(--text-main);">My Anime Collection</h3>
                    <div class="mt-3 space-y-3">
                        <a href="#" class="flex items-center gap-3 p-2 rounded-lg hover:bg-white/50 transition-colors">
                            <img src="./assets/evangelion.png" alt="Anime Art" class="w-12 h-12 rounded-lg object-cover">
                            <div class="flex-1 min-w-0"><div class="text-sm font-semibold truncate">Neon Genesis Evangelion</div><div class="text-xs text-[var(--muted)] truncate">Hideaki Anno</div></div>
                            <div class="text-xs text-purple-500 font-bold">#1</div>
                        </a>
                        <a href="#" class="flex items-center gap-3 p-2 rounded-lg hover:bg-white/50 transition-colors">
                            <img src="./assets/bocchi.png" alt="Anime Art" class="w-12 h-12 rounded-lg object-cover">
                            <div class="flex-1 min-w-0"><div class="text-sm font-semibold truncate">Bocchi the Rock!</div><div class="text-xs text-[var(--muted)] truncate">CloverWorks</div></div>
                            <div class="text-xs text-pink-500 font-bold">#2</div>
                        </a>
                         <a href="#" class="flex items-center gap-3 p-2 rounded-lg hover:bg-white/50 transition-colors">
                            <img src="./assets/jojo.png" alt="Anime Art" class="w-12 h-12 rounded-lg object-cover">
                            <div class="flex-1 min-w-0"><div class="text-sm font-semibold truncate">JoJo's Bizarre Adventure</div><div class="text-xs text-[var(--muted)] truncate">Hirohiko Araki</div></div>
                            <div class="text-xs text-amber-500 font-bold">#3</div>
                        </a>
                    </div>
                </div>
            </aside>
        </main>
    </div>

    <script>
        // ======================= Sakura Petals =======================
        const petalWrap = document.getElementById('petal-wrap');
        if (petalWrap) {
            for (let i = 0; i < 8; i++) {
                const p = document.createElement('div');
                p.className = 'petal';
                p.style.left = Math.random() * 100 + 'vw';
                p.style.animation = `fall ${10 + Math.random() * 10}s linear ${Math.random() * 10}s infinite`;
                p.innerHTML = '🌸';
                petalWrap.appendChild(p);
            }
        }

        // ======================= AI Chatbot (Ollama via Open WebUI) =======================
        const chatForm = document.getElementById('chat-form');
        const chatInput = document.getElementById('chat-input');
        const chatContainer = document.getElementById('chat-container');
        
        const OLLAMA_API_URL = 'https://mypookie.kawaii-san.org/v1'; 
        const OLLAMA_API_KEY = 'YOUR_API_KEY_HERE';
        const OLLAMA_MODEL = 'llama3'; 

        let conversationHistory = [];

        function addMessageToChat(sender, message) {
            const messageWrapper = document.createElement('div');
            messageWrapper.className = `flex ${sender === 'user' ? 'justify-end' : 'justify-start'}`;
            const messageBubble = document.createElement('div');
            messageBubble.className = `chat-bubble ${sender}`;
            messageBubble.textContent = message;
            messageWrapper.appendChild(messageBubble);
            chatContainer.appendChild(messageWrapper);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }
        
        if (chatForm) {
            chatForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const userInput = chatInput.value.trim();
                if (!userInput || OLLAMA_API_KEY === 'YOUR_API_KEY_HERE') {
                    if (OLLAMA_API_KEY === 'YOUR_API_KEY_HERE') {
                        addMessageToChat('bot', 'Please set your Open WebUI API key in the script to enable the chatbot.');
                    }
                    return;
                }

                addMessageToChat('user', userInput);
                chatInput.value = '';
                conversationHistory.push({ role: 'user', content: userInput });

                try {
                    const response = await fetch(`${OLLAMA_API_URL}/chat/completions`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${OLLAMA_API_KEY}`
                        },
                        body: JSON.stringify({
                            model: OLLAMA_MODEL,
                            messages: conversationHistory
                        })
                    });

                    if (!response.ok) {
                        throw new Error(`API request failed. Status: ${response.status}. Make sure your Open WebUI instance has CORS enabled for this domain.`);
                    }

                    const data = await response.json();
                    const botResponse = data.choices[0].message.content;
                    
                    addMessageToChat('bot', botResponse);
                    conversationHistory.push({ role: 'assistant', content: botResponse });

                } catch (error) {
                    console.error('Error fetching from Ollama API:', error);
                    addMessageToChat('bot', `Sorry, I couldn't connect to the AI. Error: ${error.message}`);
                }
            });
        }


        // ======================= Jukebox (Navidrome Integration & Real Visualizer) =======================
        const navidromeConfig = {
            url: 'https://music.kawaii-san.org',
            user: 'homepage-api',
            pass: 'h0mers1mps0n', 
            params: `u=homepage-api&p=h0mers1mps0n&v=1.16.1&c=kawaii-hub&f=json`
        };

        let jukeboxPlaylist = [];
        let currentTrackIndex = 0;
        let audio = null;
        let audioContext, analyser, source, dataArray;
        let visualizerFrameId;
        const visualizerContainer = document.getElementById('visualizer');
        const albumGrid = document.getElementById('album-grid');

        const NUM_BARS = 16;
        for(let i = 0; i < NUM_BARS; i++) {
            const bar = document.createElement('div');
            bar.className = 'bar';
            visualizerContainer.appendChild(bar);
        }
        const visualizerBars = visualizerContainer.getElementsByClassName('bar');

        function setupAudioApi() {
            if (!audioContext) {
                audio = new Audio();
                audio.crossOrigin = "anonymous";
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
                analyser = audioContext.createAnalyser();
                analyser.fftSize = 64;
                source = audioContext.createMediaElementSource(audio);
                source.connect(analyser);
                analyser.connect(audioContext.destination);
                dataArray = new Uint8Array(analyser.frequencyBinCount);
            }
        }

        function drawVisualizer() {
            analyser.getByteFrequencyData(dataArray);
            for (let i = 0; i < NUM_BARS; i++) {
                const barHeight = Math.pow(dataArray[i] / 255, 2) * 100;
                visualizerBars[i].style.height = `${Math.max(4, barHeight)}%`;
            }
            visualizerFrameId = requestAnimationFrame(drawVisualizer);
        }

        async function callNavidromeAPI(endpoint, extraParams = '') {
            try {
                const response = await fetch(`${navidromeConfig.url}/rest/${endpoint}?${navidromeConfig.params}&${extraParams}`);
                if (!response.ok) throw new Error(`Navidrome API error: ${response.statusText}`);
                const data = await response.json();
                if (data['subsonic-response'].status === 'failed') {
                    throw new Error(`Navidrome error: ${data['subsonic-response'].error.message}`);
                }
                return data['subsonic-response'];
            } catch (error) {
                console.error('Navidrome API call failed:', error);
                if (albumGrid) albumGrid.innerHTML = `<p class="text-center col-span-full">Error: Could not connect to Navidrome.</p>`;
                return null;
            }
        }

        async function loadAlbum(albumName) {
            document.getElementById('track-info').textContent = `Loading ${albumName}...`;
            const searchData = await callNavidromeAPI('search3', `query=${encodeURIComponent(albumName)}&albumCount=1&songCount=0&artistCount=0`);
            if (searchData && searchData.searchResult3.album && searchData.searchResult3.album.length > 0) {
                const albumId = searchData.searchResult3.album[0].id;
                const albumData = await callNavidromeAPI('getAlbum', `id=${albumId}`);
                if (albumData && albumData.album) {
                    jukeboxPlaylist = albumData.album.song;
                    currentTrackIndex = 0;
                    playCurrentTrackInPlaylist();
                }
            } else {
                 document.getElementById('track-info').textContent = `Album "${albumName}" not found.`;
            }
        }

        function playCurrentTrackInPlaylist() {
            if (!audio) setupAudioApi();
            if (jukeboxPlaylist.length === 0 || currentTrackIndex >= jukeboxPlaylist.length) {
                stopAudio();
                return;
            }
            
            audio.removeEventListener('ended', nextTrack);
            audio.addEventListener('ended', nextTrack);
            
            const track = jukeboxPlaylist[currentTrackIndex];
            const streamUrl = `${navidromeConfig.url}/rest/stream?id=${track.id}&${navidromeConfig.params}`;
            audio.src = streamUrl;
            audio.play().then(() => {
                visualizerContainer.style.opacity = '1';
                if (visualizerFrameId) cancelAnimationFrame(visualizerFrameId);
                drawVisualizer();
                document.getElementById('track-info').textContent = `Playing: ${track.title} - ${track.artist}`;
            }).catch(e => console.error("Audio play failed:", e));
        }

        function stopAudio() {
            if (audio) audio.pause();
            visualizerContainer.style.opacity = '0';
            if (visualizerFrameId) cancelAnimationFrame(visualizerFrameId);
            document.getElementById('track-info').textContent = 'Ready to play...';
        }
        
        function nextTrack() {
            if (currentTrackIndex < jukeboxPlaylist.length - 1) {
                currentTrackIndex++;
                playCurrentTrackInPlaylist();
            } else {
                stopAudio();
            }
        }
        
        function prevTrack() {
            if (audio && audio.currentTime > 4) {
                audio.currentTime = 0;
            } else if (currentTrackIndex > 0) {
                currentTrackIndex--;
                playCurrentTrackInPlaylist();
            }
        }

        document.getElementById('play-btn')?.addEventListener('click', () => {
             if (!audio || audio.paused) {
                if (jukeboxPlaylist.length === 0) {
                    // Does nothing until an album is clicked.
                } else {
                    playCurrentTrackInPlaylist();
                }
             }
        });
        document.getElementById('stop-btn')?.addEventListener('click', stopAudio);
        document.getElementById('next-btn')?.addEventListener('click', nextTrack);
        document.getElementById('prev-btn')?.addEventListener('click', prevTrack);

        albumGrid?.addEventListener('click', (e) => {
            const button = e.target.closest('button');
            if (button && button.dataset.albumName) {
                loadAlbum(button.dataset.albumName);
            }
        });

        // ======================= System Health (Netdata Integration) =======================
        async function updateSystemHealth() {
            const setContent = (id, text) => {
                const el = document.getElementById(id);
                if (el) el.textContent = text;
            };

            try {
                const response = await fetch('https://monitor.kawaii-san.org/api/v1/info');
                if (!response.ok) throw new Error('Netdata not reachable');
                
                // Fetch CPU
                const cpuRes = await fetch('https://monitor.kawaii-san.org/api/v1/data?chart=system.cpu&after=-1&points=1&group=average&format=json');
                const cpuData = await cpuRes.json();
                setContent('cpu-usage', `${cpuData.data[0][1].toFixed(2)}%`);

                // Fetch RAM
                const ramRes = await fetch('https://monitor.kawaii-san.org/api/v1/data?chart=system.ram&after=-1&points=1&group=average&format=json');
                const ramData = await ramRes.json();
                const ramUsed = ramData.data[0][ramData.dimension_names.indexOf('used')];
                const ramTotal = (ramData.data[0][ramData.dimension_names.indexOf('free')] + ramData.data[0][ramData.dimension_names.indexOf('used')])/1024;
                setContent('memory-usage', `${(ramUsed/1024).toFixed(2)}GB / ${ramTotal.toFixed(2)}GB`);

                // Fetch Uptime
                const uptimeRes = await fetch('https://monitor.kawaii-san.org/api/v1/data?chart=system.uptime&after=-1&points=1&group=average&format=json');
                const uptimeData = await uptimeRes.json();
                const uptimeSeconds = uptimeData.data[0][1];
                const days = Math.floor(uptimeSeconds / (3600*24));
                setContent('uptime', `${days} days`);

            } catch (error) {
                console.error("Netdata API failed, using fallback data.", error);
                // Fallback to random data if API fails
                setContent('cpu-usage', `${Math.floor(5 + Math.random() * 25)}%`);
                setContent('memory-usage', `${(2 + Math.random() * 6).toFixed(1)}GB / 16GB`);
                setContent('uptime', `${Math.floor(1 + Math.random() * 30)} days`);
            }
        }

        async function updateWeather() {
            const weatherEl = document.getElementById('weather-info');
            if (!weatherEl) return;
            try {
                const response = await fetch('https://wttr.in/Singapore?format=%C+%t');
                const weatherText = await response.text();
                weatherEl.textContent = weatherText.trim() || 'Weather unavailable';
            } catch (error) {
                weatherEl.textContent = 'Partly Cloudy, 29°C 🌤️';
            }
        }

        // ======================= Initial Load =======================
        document.addEventListener('DOMContentLoaded', () => {
            updateSystemHealth();
            updateWeather();
            setInterval(updateSystemHealth, 5000); // Update health more frequently
            setInterval(updateWeather, 300000);
        });

        // ======================= Night Mode Toggle =======================
        const themeBtn = document.getElementById('theme-toggle');
        let isNightMode = false;
        function setNightMode(on) {
            isNightMode = on;
            document.documentElement.classList.toggle('night-mode', on);
            if(themeBtn) themeBtn.textContent = on ? 'Day Mode' : 'Night Mode';
        }
        themeBtn?.addEventListener('click', () => setNightMode(!isNightMode));
        window.addEventListener('keydown', (e) => { if (e.key === '~') setNightMode(!isNightMode); });

        // ======================= Utility Functions =======================
        function copyToClipboard(text, buttonElement) {
            const originalText = buttonElement.innerHTML;
            navigator.clipboard.writeText(text).then(() => {
                buttonElement.innerHTML = 'Copied!';
                setTimeout(() => { buttonElement.innerHTML = originalText; }, 2000);
            }).catch(err => {
                console.error('Failed to copy: ', err);
                alert('Failed to copy. Please copy manually!');
            });
        }
    </script>
</body>
</html>
